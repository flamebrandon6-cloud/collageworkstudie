<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>collageworkstudie â€” Pack & Quiz</title>
<style>
  :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8; color-scheme: dark;}
  body{margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";background:linear-gradient(180deg,#071029 0%, #071a2a 60%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;}
  .app{width:980px;max-width:100%;display:grid;grid-template-columns:1fr 360px;gap:20px}
  header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
  h1{margin:0;font-size:20px}
  .main{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;padding:18px}
  .side{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;padding:18px;min-height:280px}
  button{background:var(--accent);border:none;color:#062233;padding:10px 14px;border-radius:8px;font-weight:600;cursor:pointer}
  .packs{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  .pack{background:var(--card);padding:12px;border-radius:8px;min-width:140px;text-align:center}
  .collection{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
  .blook{padding:8px;border-radius:8px;background:rgba(255,255,255,0.03);min-width:56px;text-align:center}
  .log{font-size:13px;color:var(--muted);margin-top:12px;max-height:120px;overflow:auto;padding:8px;background:rgba(0,0,0,0.12);border-radius:8px}
  .controls{display:flex;gap:8px;align-items:center}
  footer{font-size:12px;color:var(--muted);margin-top:12px}
  .big-btn{font-size:16px;padding:14px 18px}
  .pack-open{font-weight:700}
  .search{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
  @media(max-width:880px){.app{grid-template-columns:1fr;}.side{order:2}}
</style>
</head>
<body>
<div class="app" role="application" aria-label="collageworkstudie game app">
  <header>
    <h1>collageworkstudie â€” Pack & Quiz demo</h1>
    <div>
      <span id="status">Offline-capable</span>
    </div>
  </header>

  <section class="main" aria-label="main area">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="color:var(--muted);font-size:13px">Coins</div>
        <div id="coins" style="font-size:22px;font-weight:700">0</div>
      </div>
      <div class="controls">
        <button id="openPack" class="big-btn pack-open">Open Pack (50 coins)</button>
        <button id="randomQuiz">Random Quiz</button>
      </div>
    </div>

    <div style="margin-top:12px;color:var(--muted)">Packs you can open:</div>
    <div class="packs" id="packs"></div>

    <div style="margin-top:18px">
      <h3 style="margin:0 0 8px 0">Your collection</h3>
      <div class="collection" id="collection"></div>
    </div>

    <div style="margin-top:16px">
      <h3 style="margin:0 0 8px 0">Activity log</h3>
      <div class="log" id="log"></div>
    </div>
    <footer>Tip: This runs entirely in your browser. Works offline after first load.</footer>
  </section>

  <aside class="side" aria-label="sidebar">
    <h3 style="margin-top:0">Pack editor (edit in GitHub.dev)</h3>
    <div style="color:var(--muted);font-size:13px">Create pack types that give random items (emojis).</div>

    <div style="margin-top:12px">
      <input id="packName" class="search" placeholder="Pack name (e.g. Starter Pack)" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <input id="packItems" class="search" placeholder="Items (comma separated, emojis ok)" />
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="addPack">Add/Update Pack</button>
        <button id="resetData" style="background:#ef4444;color:white">Reset</button>
      </div>
    </div>

    <div style="margin-top:14px">
      <h4 style="margin:6px 0 6px 0">Quick quiz</h4>
      <div style="color:var(--muted);font-size:13px">Press "Random Quiz" to get a 1-question quiz.</div>
    </div>
  </aside>
</div>

<script>
/* --- Simple client-side pack/collectible + quiz app --- */
const DEFAULT_PACKS = [
  {name:'Starter Pack', items:['ðŸ˜º','ðŸ¶','ðŸ¦„','ðŸ¼','ðŸ™','ðŸ¢'], price:50},
  {name:'Emoji Pack', items:['ðŸš€','ðŸ’Ž','ðŸŽ¯','âš¡ï¸','ðŸ”¥','ðŸŒˆ'], price:80}
];

const $ = id=>document.getElementById(id);
const log = msg => {
  const el = $('log'); el.innerHTML = `<div>${new Date().toLocaleTimeString()} â€” ${msg}</div>` + el.innerHTML;
};

function loadState(){
  try{
    const raw = localStorage.getItem('cw_state');
    if(!raw) return {coins:200, packs:DEFAULT_PACKS, collection:[]};
    return JSON.parse(raw);
  }catch(e){return {coins:200, packs:DEFAULT_PACKS, collection:[]};}
}
function saveState(){localStorage.setItem('cw_state', JSON.stringify(state)); renderAll();}

let state = loadState();

function renderPacks(){
  const container = document.createElement('div');
  $('packs').innerHTML = '';
  state.packs.forEach((p, idx)=>{
    const d = document.createElement('div'); d.className='pack';
    d.innerHTML = `<strong>${p.name}</strong><div style="color:var(--muted);font-size:13px">Price: ${p.price}</div>
      <div style="margin-top:8px"><button data-idx="${idx}" class="open">Open</button></div>`;
    $('packs').appendChild(d);
  });
  document.querySelectorAll('.open').forEach(b=>{
    b.addEventListener('click', e=>{
      const idx = +b.getAttribute('data-idx');
      openPack(idx);
    });
  });
}

function renderCollection(){
  $('collection').innerHTML = '';
  if(state.collection.length===0) $('collection').innerHTML = '<div style="color:var(--muted)">No items yet â€” open a pack.</div>';
  state.collection.forEach(item=>{
    const d = document.createElement('div'); d.className='blook';
    d.innerHTML = `${item}`;
    $('collection').appendChild(d);
  });
}

function renderAll(){
  $('coins').textContent = state.coins;
  renderPacks();
  renderCollection();
}
renderAll();

function getRandom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

function openPack(idx){
  const pack = state.packs[idx];
  if(!pack){log('Pack missing.'); return;}
  if(state.coins < pack.price){log('Not enough coins.'); return;}
  state.coins -= pack.price;
  // give 1-3 items
  const n = Math.random() < 0.2 ? 3 : 1;
  for(let i=0;i<n;i++){
    const it = getRandom(pack.items);
    state.collection.push(it);
  }
  log(`Opened ${pack.name}, got ${n} item(s).`);
  // small coin reward occasionally
  if(Math.random()<0.25){ const reward = 20; state.coins += reward; log(`Lucky! you found ${reward} coins inside a pack.`); }
  saveState();
}

$('openPack').addEventListener('click', ()=> {
  // open first pack by default for the big button
  openPack(0);
});

$('addPack').addEventListener('click', ()=>{
  const name = $('packName').value.trim(); const itemsRaw = $('packItems').value.trim();
  if(!name || !itemsRaw){ alert('Enter name and items (comma separated)'); return; }
  const items = itemsRaw.split(',').map(s=>s.trim()).filter(Boolean);
  // add pack
  state.packs.push({name, items, price:50});
  log(`Pack "${name}" added.`);
  saveState();
});

$('resetData').addEventListener('click', ()=> {
  if(!confirm('Reset all saved data (coins, packs, collection)?')) return;
  localStorage.removeItem('cw_state'); state = loadState(); renderAll(); log('Data reset.');
});

// quick quiz
const QUESTIONS = [
  {q:'What color is the sky on a clear day?', a:'Blue', choices:['Red','Blue','Green','Black']},
  {q:'2+2 = ?', a:'4', choices:['3','4','5','6']},
  {q:'Which animal says "meow"?', a:'Cat', choices:['Dog','Cat','Cow','Sheep']}
];
$('randomQuiz').addEventListener('click', ()=> {
  const q = getRandom(QUESTIONS);
  const ans = prompt(q.q + '\\n' + q.choices.map((c,i)=>`${i+1}. ${c}`).join('\\n') + '\\n\\nType the answer text (e.g. Blue)');
  if(ans === null) return;
  if(ans.trim().toLowerCase() === q.a.toLowerCase()){
    state.coins += 30; saveState();
    alert('Correct! +30 coins');
    log('Correct quiz answer. +30 coins.');
  } else {
    alert('Not quite. The answer was: ' + q.a);
    log('Quiz answered incorrectly.');
  }
});

// service worker registration (for offline)
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').then(()=>console.log('SW registered')).catch(()=>console.log('SW failed'));
}

// small friendly note for users opening from GitHub.dev: press dot to edit live
</script>
</body>
</html>
